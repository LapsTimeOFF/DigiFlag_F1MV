(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function a(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(i){if(i.ep)return;i.ep=!0;const c=a(i);fetch(i.href,c)}})();var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},W={},R={},S={},le={get exports(){return S},set exports(e){S=e}};(function(e,t){var a=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Z<"u")return Z;throw new Error("unable to locate global object")},n=a();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response})(le,S);Object.defineProperty(R,"__esModule",{value:!0});R.getAPIVersion=R.getF1MVVersion=void 0;const ce=S;async function oe(e){const t=`http://${e.host}:${e.port}/api/v1/app/version`,n=await(await(0,ce.default)(t)).json();let{version:i}=n;return i=parseInt(i.replace(/[\D]/g,"")),i}R.getF1MVVersion=oe;async function de(e,t,a){let n;return t?n=a:n=await oe(e),n>=180&&n<1100?"v2":n>=1100?"graphql":"v1"}R.getAPIVersion=de;var U={},G={};Object.defineProperty(G,"__esModule",{value:!0});G.testConnection=void 0;const ue=S;async function pe(e){try{const t=await(await(0,ue.default)(`http://${e.host}:${e.port}/api/v1/app/version`)).json();return t.version!==void 0?t:!1}catch{return!1}}G.testConnection=pe;var T={};Object.defineProperty(T,"__esModule",{value:!0});T.invalidTopic=T.noInstanceFounded=void 0;T.noInstanceFounded=new Error("No MultiViewer instances founded on the requested host. Check if MultiViewer is running or if MultiViewer is allowed in your FireWall rules.");T.invalidTopic=new Error("Invalid Topic requested.");Object.defineProperty(U,"__esModule",{value:!0});U.discoverF1MVInstances=void 0;const fe=G,ge=T;async function me(e){let t=10101,a=!1;for(let n=t;n<10111;n++){let i={host:e,port:n};if(await(0,fe.testConnection)(i)!==!1){t=n,a=!0;break}}if(!a)throw ge.noInstanceFounded;return{instanceFounded:!0,port:t}}U.discoverF1MVInstances=me;var h={};Object.defineProperty(h,"__esModule",{value:!0});h.LiveTimingClockAPIGraphQL=h.LiveTimingAPIGraphQL=h.LiveTimingAPIV2=h.LiveTimingAPIV1=void 0;const H=T,z=S;async function he(e,t){const a=await(await(0,z.default)(`http://${e.host}:${e.port}/api/v1/live-timing/${t}`)).json();return a.success===!1?H.invalidTopic:a}h.LiveTimingAPIV1=he;async function ye(e,t){const a=await(await(0,z.default)(`http://${e.host}:${e.port}/api/v2/live-timing/state/${typeof t=="object"?t.join(","):t}`)).json();return a.success===!1?H.invalidTopic:a}h.LiveTimingAPIV2=ye;async function be(e,t){const{data:a}=await(await(0,z.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`query LiveTimingState {
                            liveTimingState {
                                ${typeof t=="object"?t.join(`
`):t}
                            }
                        }`,operationName:"LiveTimingState"}),method:"POST"})).json();return a.success===!1?H.invalidTopic:a.liveTimingState}h.LiveTimingAPIGraphQL=be;async function ve(e,t){const{data:a}=await(await(0,z.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`query LiveTimingClock {
                            liveTimingClock {
                                ${typeof t=="object"?t.join(`
`):t}
                            }
                        }`,operationName:"LiveTimingClock"}),method:"POST"})).json();return a.success===!1?H.invalidTopic:a.liveTimingClock}h.LiveTimingClockAPIGraphQL=ve;var ie={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getCircuitInfo=e.getFIA_Documents=e.baseURL=void 0;const t=S;e.baseURL="https://api.multiviewer.app/api/v1";async function a(i){return await(await(0,t.default)(`${e.baseURL}/fia-documents/${i}`)).json()}e.getFIA_Documents=a;async function n(i,c){return await(await(0,t.default)(`${e.baseURL}/circuits/${i}/${c}`)).json()}e.getCircuitInfo=n})(ie);var d={};Object.defineProperty(d,"__esModule",{value:!0});d.removePlayer=d.syncPlayers=d.createPlayer=d.setAlwaysOnTop=d.setSpeedometerVisibility=d.getAllPlayers=d.setPlayerBounds=d.getPlayerBounds=void 0;const L=S;async function $e(e,t){return(await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`query Player($playerId: ID!) {
                player(id: $playerId) {
                  bounds {
                    height
                    width
                    x
                    y
                  }
                }
              }`,variables:{playerId:t},operationName:"Player"}),method:"POST"})).json()).data.player.bounds}d.getPlayerBounds=$e;async function we(e,t,a){return await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerSetBounds($playerSetBoundsId: ID!, $bounds: RectangleInput!) {
                playerSetBounds(id: $playerSetBoundsId, bounds: $bounds) {
                  x
                  y
                }
              }`,variables:{playerSetBoundsId:t,bounds:{x:a.x,y:a.y}},operationName:"PlayerSetBounds"}),method:"POST"})).json()}d.setPlayerBounds=we;async function Se(e){return(await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`query DriverData {
                    players {
                      driverData {
                        driverNumber
                      }
                      id
                      streamData {
                        contentId
                        title
                      }
                    }
                  }`,variables:{},operationName:"DriverData"}),method:"POST"})).json()).data.players}d.getAllPlayers=Se;async function Pe(e,t,a){return(await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerSetSpeedometerVisibility($playerSetSpeedometerVisibilityId: ID!, $visible: Boolean) {
                playerSetSpeedometerVisibility(id: $playerSetSpeedometerVisibilityId, visible: $visible)
              }`,variables:{playerSetSpeedometerVisibilityId:t,visible:a},operationName:"PlayerSetSpeedometerVisibility"}),method:"POST"})).json()).data.playerSetSpeedometerVisibility}d.setSpeedometerVisibility=Pe;async function Ie(e,t,a,n){return(await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerSetAlwaysOnTop($playerSetAlwaysOnTopId: ID!, $alwaysOnTop: Boolean, $level: AlwaysOnTopLevel) {
                    playerSetAlwaysOnTop(id: $playerSetAlwaysOnTopId, alwaysOnTop: $alwaysOnTop, level: $level)
                  }`,variables:{playerSetAlwaysOnTopId:t,alwaysOnTop:a,level:n},operationName:"PlayerSetAlwaysOnTop"}),method:"POST"})).json()).data.playerSetAlwaysOnTop}d.setAlwaysOnTop=Ie;async function ke(e,t,a,n,i,c,g){return await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerCreate($input: PlayerCreateInput!) {
                playerCreate(input: $input)
              }`,variables:{input:{bounds:n,contentId:a,driverNumber:typeof t=="string"?parseInt(t):t,maintainAspectRatio:i??!0,streamTitle:c,alwaysOnTop:g??!1}},operationName:"PlayerCreate"}),method:"POST"})).json()}d.createPlayer=ke;async function Me(e,t){return await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerSync($playerSyncId: ID!) {
                playerSync(id: $playerSyncId)
              }`,variables:{playerSyncId:t},operationName:"PlayerSync"}),method:"POST"})).json()}d.syncPlayers=Me;async function Te(e,t){return await(await(0,L.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:`mutation PlayerDelete($playerDeleteId: ID!) {
                playerDelete(id: $playerDeleteId)
              }`,variables:{playerDeleteId:t},operationName:"PlayerDelete"}),method:"POST"})).json()}d.removePlayer=Te;var J={};Object.defineProperty(J,"__esModule",{value:!0});J.customGraphQL=void 0;const Ce=S;async function Le(e,t,a,n){return await(await(0,Ce.default)(`http://${e.host}:${e.port}/api/graphql`,{headers:{"content-type":"application/json"},body:JSON.stringify({query:t,variables:a,operationName:n}),method:"POST"})).json()}J.customGraphQL=Le;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.invalidTopic=e.noInstanceFounded=e.testConnection=e.LiveTimingClockAPIGraphQL=e.LiveTimingAPIGraphQL=e.LiveTimingAPIV2=e.LiveTimingAPIV1=e.discoverF1MVInstances=e.customGraphQL=e.getAllPlayers=e.setAlwaysOnTop=e.setSpeedometerVisibility=e.setPlayerBounds=e.syncPlayers=e.removePlayer=e.createWindow=e.createPlayer=e.getPlayerBounds=e.getCircuitInfo=e.getFIA_Documents=e.getF1MVVersion=e.getAPIVersion=void 0;const t=R;Object.defineProperty(e,"getF1MVVersion",{enumerable:!0,get:function(){return t.getF1MVVersion}}),Object.defineProperty(e,"getAPIVersion",{enumerable:!0,get:function(){return t.getAPIVersion}});const a=U;Object.defineProperty(e,"discoverF1MVInstances",{enumerable:!0,get:function(){return a.discoverF1MVInstances}});const n=h;Object.defineProperty(e,"LiveTimingAPIGraphQL",{enumerable:!0,get:function(){return n.LiveTimingAPIGraphQL}}),Object.defineProperty(e,"LiveTimingAPIV1",{enumerable:!0,get:function(){return n.LiveTimingAPIV1}}),Object.defineProperty(e,"LiveTimingAPIV2",{enumerable:!0,get:function(){return n.LiveTimingAPIV2}}),Object.defineProperty(e,"LiveTimingClockAPIGraphQL",{enumerable:!0,get:function(){return n.LiveTimingClockAPIGraphQL}});const i=G;Object.defineProperty(e,"testConnection",{enumerable:!0,get:function(){return i.testConnection}});const c=T;Object.defineProperty(e,"noInstanceFounded",{enumerable:!0,get:function(){return c.noInstanceFounded}}),Object.defineProperty(e,"invalidTopic",{enumerable:!0,get:function(){return c.invalidTopic}});const g=ie;Object.defineProperty(e,"getFIA_Documents",{enumerable:!0,get:function(){return g.getFIA_Documents}}),Object.defineProperty(e,"getCircuitInfo",{enumerable:!0,get:function(){return g.getCircuitInfo}});const m=d;Object.defineProperty(e,"createPlayer",{enumerable:!0,get:function(){return m.createPlayer}}),Object.defineProperty(e,"createWindow",{enumerable:!0,get:function(){return m.createPlayer}}),Object.defineProperty(e,"getAllPlayers",{enumerable:!0,get:function(){return m.getAllPlayers}}),Object.defineProperty(e,"getPlayerBounds",{enumerable:!0,get:function(){return m.getPlayerBounds}}),Object.defineProperty(e,"removePlayer",{enumerable:!0,get:function(){return m.removePlayer}}),Object.defineProperty(e,"setAlwaysOnTop",{enumerable:!0,get:function(){return m.setAlwaysOnTop}}),Object.defineProperty(e,"setPlayerBounds",{enumerable:!0,get:function(){return m.setPlayerBounds}}),Object.defineProperty(e,"setSpeedometerVisibility",{enumerable:!0,get:function(){return m.setSpeedometerVisibility}}),Object.defineProperty(e,"syncPlayers",{enumerable:!0,get:function(){return m.syncPlayers}});const re=J;Object.defineProperty(e,"customGraphQL",{enumerable:!0,get:function(){return re.customGraphQL}})})(W);const Ae="2.5.1-Web",Oe="localhost",Ne=10101,f={host:Oe,port:Ne},u=e=>new Promise(t=>setTimeout(t,e)),{themes:M,mapThemes:q}=JSON.parse(Q("./filesConfiguration.json"));let o=!0,A=1,_=!1,O=!1,b=!1,v=!1,w=!1,B=!1,ee,V={RaceControlMessages:{Messages:[{Message:"",Category:"",SubCategory:"",RacingNumber:"",Flag:"",Scope:"",Sector:"",Mode:""}]},TrackStatus:{Status:"",Message:""},WeatherData:{AirTemp:"",Humidity:"",Pressure:"",Rainfall:"",TrackTemp:"",WindDirection:"",WindSpeed:""}},j=!1,D=!1,C=1,X=0,N="Unknown",s=0,P=!1,y=!1,I=!1,F;const Fe=800,De=600,Re=100,Ve=200;let te={Messages:[{Message:"",Category:"",SubCategory:"",Flag:"",Scope:"",Sector:"",Mode:""}]};function Q(e){const t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}const K=[];function r(e){console.log(e),K[K.length-1]!==e&&K.push(e)}let E=!1;async function x(){try{let e=3;if(E===!1){const t=setInterval(()=>{e<=0?(ne(),je(),clearInterval(t),E=!1):(E=!0,$("#tagLink").hasClass("badge text-bg-danger")?($("#tagLink").text("Retrying to Connect to F1MV in : "+e+" seconds"),$("#raceName").text("Attempting to Get Current Session Info From F1MV...")):$("#tagLink").hasClass("badge text-bg-warning")?($("#tagLink").text("Attempting to Connect to Live / Replay Timing Window : "+e+" seconds"),$("#raceName").text("Retrieving Current Session From F1MV...")):($("#tagLink").removeClass(),$("#tagSession").removeClass(),$("#raceName").removeClass(),$("#checkNetworkSettings,#infoTag").hide(),$("#tagLink").addClass("badge text-bg-primary"),$("#tagSession").addClass("badge text-bg-primary"),$("#raceName").addClass("text-bg-primary"),$("#raceName").text("Retrieving Current Session From F1MV..."),$("#tagLink").text("Attempting to Connect to F1MV in : "+e+" seconds"))),e-=1},1e3)}}catch(e){console.error(e),ne()}}async function je(){try{const e=await W.LiveTimingAPIGraphQL(f,["SessionInfo"]),t=await e.SessionInfo.Meeting.Name,a=await e.SessionInfo.Name;return N=`${parseInt(e.SessionInfo.StartDate)+" "+t}`,$("#raceName").text(N+" "+a),o&&console.log(`Current Race Name: ${N}`),N}catch(e){return o&&console.error(`Unable to Get Data From F1MV GraphQL API:
`+e.message),"Unable to Get Data From F1MV GraphQL API"}}async function xe(){try{const t=await(await fetch("https://app.divoom-gz.com/Device/ReturnSameLANDevice",{method:"POST",headers:{"Content-Type":"application/json"}})).json();return t.ReturnCode===0&&t.DeviceList.length>0?(F=t.DeviceList[0].DevicePrivateIP,console.log("Pixoo64 IP Address:",F),F):(console.log("Failed to retrieve Pixoo64 IP Address"),"Failed to retrieve Pixoo64 IP Address")}catch(e){return e instanceof Error&&console.log(e.message),"Failed to retrieve Pixoo64 IP Address"}}function se(e){let t;const a=q[e].trackMaps;return N in a?(t=a[N],o&&console.log(`Track Map Path: ${t}`),t):(o&&console.log("Map Not Found"),"Map Not Found")}function Ge(e,t){$(".toast").remove(),localStorage.setItem("host",e),t>=0&&t<=65535?(localStorage.setItem("port",t.toString()),o&&r("Network Settings Saved !"),$("#networkSettings > h5").after(`<div class="toast text-bg-dark" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="3000" data-bs-autohide="true">
        <div class="toast-header text-bg-success">
          <strong class="text-center me-auto">Network Settings Saved!</strong>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
        <p>Host:${e}</p>
        <p>Port:${t}</p>
        </div>
    </div>
    `),$(".toast").toast("show"),x()):(o&&r("Only Host Settings Saved !"),$("#networkSettings > h5").after(`<div class="toast text-bg-dark" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000" data-bs-autohide="true">
        <div class="toast-header text-bg-danger">
          <strong class="me-auto">ERROR: Invalid Port!</strong>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
        Only Host Settings Saved !
        <p>The Port Number ${t} is invalid. Please Enter a Valid Port Number Between 0 to 65535.</p>
        </div>
    </div>
        `),$(".toast").toast("show"))}function ae(e,t){arguments.length==0&&(e="./index.html",t="DigiFlag Instance");try{return window.open(e,"_blank",`left=${Re},top=${Ve},frame=${!1},
            transparent=${!0},menubar=no,autoHideMenuBar==${!1},width=${Fe},height=${De},title=${t},icon=./build/icon.ico,nodeIntegration=yes,contextIsolation=no`)}catch(a){return console.error(a),null}}function _e(){const e=localStorage.getItem("host"),t=localStorage.getItem("port");e&&t!==null&&(f.host=e,f.port=parseInt(t))}function Be(){$(".toast").remove(),localStorage!==null&&localStorage.clear(),f.host="localhost",f.port=10101,$("#networkSettings > h5").after(`<div class="toast text-bg-dark" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000" data-bs-autohide="true">
        <div class="toast-header text-bg-danger">
          <strong class="text-center me-auto">Reset Network Settings!</strong>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
        Reset Network Settings To Default Values!
        </div>
    </div>
    `),$(".toast").toast("show"),o&&r("Reset Network Settings To Default"),x()}function Ee(e){return e===!0?(o&&r("Debug Mode Enabled"),o=!0):(o&&r("Debug Mode Disabled"),o=!1),!0}Ee(o);function k(e){let t="";const a=se(X);if(e==="void"&&I===!0)for(let n=0;n<M.length;n++){const i=M[n];i.id===C&&(t=i.gifs.mv)}else if(e==="void"&&y===!0&&a.slice((a.lastIndexOf(".")-1>>>0)+2))t=a;else for(let n=0;n<M.length;n++){const i=M[n];i.id===C&&(t=i.gifs[e])}return o&&r(`${e} requested, returning ${t}`),t}function qe(e){o&&r("Theme Selected: "+e),C=e,$("#nextTheme").prop("disabled",!1)}function Qe(e){y==!0&&(o&&r("Map Theme selected : "+q[e].name),X=parseInt(e),se(X),$("#launchDigiFlag").prop("disabled",!0))}async function p(e){if(e==="ss"||e==="rs"||e==="chequered"||e==="green"||e==="blue"||e==="slippery")if(b===!0)$("#digiflag").prop("src",k("sc"));else{if(v===!0){$("#digiflag").prop("src",k("vsc"));return}else if(w===!0){$("#digiflag").prop("src",k("red"));return}else if(O===!0){$("#digiflag").prop("src",k("yellow"));return}if(s.valueOf()===1){Q(`http://localhost:9093/pixoo/void/${C}/${F}`)!=="OK"&&r("Failed to change GIF on Pixoo64");return}$("#digiflag").prop("src",k("void")),j=!1}else{if(s.valueOf()===1){Q(`http://localhost:9093/pixoo/void/${C}/${F}`)!=="OK"&&r("Failed to change GIF on Pixoo64");return}$("#digiflag").prop("src",k("void")),j=!1}}async function l(e,t){if(e==="blue"&&P)return;if(t===1&&s.valueOf()===1){Q(`http://localhost:9093/pixoo/${e}/${C}/${F}`)!=="OK"&&r("Failed to change GIF on Pixoo64");return}const a=k(e);$("#digiflag").prop("src",a),e!=="rain"&&(j=!0,D=!1),e==="rain"&&(j=!1,D=!0)}function Y(){$("#tagLink").removeClass(),$("#tagSession").removeClass(),$("#raceName").removeClass(),$("#tagLink").addClass("badge text-bg-success"),$("#tagSession").addClass("badge text-bg-success"),$("#raceName").addClass("text-bg-success"),$("#tagLink").text("Successfully Connected to F1MV Timing Window"),$("#tagSession").show(),$("#linkF1MV").remove(),$("#infoTag").remove(),$("#checkNetworkSettings").remove(),$("#networkSettings").remove(),$("#selectTheme").append(`
    <p class="lead text-center fs-4 mb-1">Select a DigiFlag Theme</p>
        <div id="themes">
        </div>
        <button type="button" id="nextTheme" class="btn btn-success" disabled>Next
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-arrow-right">
  <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
</button>
    `),$("#selectDevice").append(`
    <div class="lead text-center fs-4" data-i18n="selectADevice">Select a Device</div>
        <div class="form-check" id="window">
        <input class="form-check-input" type="radio" name="flexRadioDefault" id="windowRadio" checked>
        <label class="form-check-label" for="windowRadio">
            Window DigiFlag
        </label>
        </div>
        <span class="badge text-bg-danger" data-i18n="pixoo64IsNotCompatible" id="notAvailable" disabled>Pixoo 64 is Not Compatible with the Selected Theme</span>
        <div class="form-check" id="pixoo64">
        <input class="form-check-input" type="radio" name="flexRadioDefault" id="pixoo64Radio" data-bs-toggle="collapse" data-bs-target="#pixooIPContainer" aria-expanded="false" aria-controls="pixooIPContainer" disabled>
        <label class="form-check-label" for="pixoo64Radio">
            Pixoo 64 DigiFlag
        </label>
        <div class="collapse" id="pixooIPContainer">
        <span id="pixooIP">Pixoo IP: ${F}</span>
        </div>
        </div>
    `),$("#selectMisc").append(`<div class="lead text-center fs-4" data-i18n="miscOptions">
    Misc Options
  </div>
  <div class="form-check form-switch" id="trackMapSwitch">
    <input class="form-check-input" type="checkbox" role="switch" id="mapSwitch" data-bs-toggle="collapse" data-bs-target="#collapsetrackMapSelect" aria-expanded="false" aria-controls="collapsetrackMapSelect"> <label class="form-check-label theme" data-i18n="useF1TrackMapBackground" for="mapSwitch">Use F1 Track Map Background?</label>
  </div>
  <div class="collapse" id="collapsetrackMapSelect">
    <div id="trackMapStyle">
      <select class="form-select form-select-sm text-bg-dark mapTheme" id="trackMapStyleSelect">
      </select>
    </div>
  </div>
  <div class="form-check form-switch" id="mvLogoSwitch">
    <input class="form-check-input" type="checkbox" role="switch" id="mvSwitch"> <label class="form-check-label theme" data-i18n="useMultiviewerLogo" for="mvSwitch">Use MultiViewer Logo?</label>
  </div>
  <div class="form-check form-switch" id="blueFlag">
    <input class="form-check-input" type="checkbox" role="switch" id="blueFlagCheckbox"> <label class="form-check-label theme" data-i18n="removeBlueFlags" for="blueFlagCheckbox">Remove Blue Flags?</label>
  </div>`),ee=$("#selectDevice,#selectMisc").detach();let e;for(let t=0;t<M.length;t++)e=M[t],$("#themes").append(`
            <div class="form-check" id="window">
                <input class="form-check-input theme" type="radio" name="theme" id="${e.id}">
                <label class="form-check-label theme ${e.id}" for="${e.id}">
                    ${e.name}
                </label>
            </div>
        `);$(".theme").on("change",t=>{qe(parseInt(t.target.id))}),$("#nextTheme").on("click",()=>{ee.appendTo("#menuContent"),$("#selectTheme").detach(),M[C].compatibleWith.Pixoo64?($("#notAvailable").hide(),$("#pixoo64Radio").prop("disabled",!1)):(s=0,$("#notAvailable").show(),$("#pixoo64Radio").prop("checked",!1),$("#pixooIPContainer").removeClass(),$("#pixooIPContainer").addClass("collapse"),$("#windowRadio").prop("checked",!0),$("#pixoo64Radio").prop("disabled",!0),$("#mapSwitch").prop("disabled",!1),$("#mvSwitch").prop("disabled",!1)),$("#selectDevice").on("change",t=>{t.target.id==="pixoo64Radio"?(o&&console.log("Pixoo64 was Selected"),s=1,xe(),o&&console.log("Current Mode: "+s),$("#collapsetrackMapSelect").removeClass(),$("#collapsetrackMapSelect").addClass("collapse"),$("#mapSwitch").prop("disabled",!0),$("#mapSwitch").prop("checked",!1)):(o&&console.log("Window was Selected"),s=0,$("#pixooIPContainer").removeClass(),$("#pixooIPContainer").addClass("collapse"),o&&console.log("Current Mode: "+s),$("#mapSwitch").prop("disabled",!1))}),$("#blueFlag").on("change",()=>P?(P=!1,o&&r("Blue Flags Enabled: "+P),P):(P=!0,o&&r("Blue Flags Disabled: "+P),P)),$("#mvLogoSwitch").on("change",()=>I?(I=!1,o&&r("MV Logo Enabled: "+I),$("#mapSwitch").prop("disabled",!1),I):(I=!0,o&&r("MV Logo Disabled: "+I),$("#mapSwitch").prop("disabled",!0),I)),$("#trackMapSwitch").on("change",()=>{if(y)return y=!1,o&&r("use TrackMap as Background? : "+y),$("#mvSwitch").prop("disabled",!1),$("#launchDigiFlag").prop("disabled",!1),y;y=!0,o&&r("use TrackMap as Background? : "+y),$("#mvSwitch").prop("disabled",!0),$("#launchDigiFlag").prop("disabled",!0),$("#trackMapStyleSelect>option").remove(),$("#trackMapStyleSelect").append('<option  data-i18n="selectAMapStyle"  value="none" selected disabled hidden>Select a Map Style</option>');for(let t=0;t<q.length;t++){const a=q[t];$("#trackMapStyleSelect").append(`<option id=${a.id} value=${a.id}>${a.name}</option> `)}return $("#trackMapStyleSelect").on("change",()=>{const t=$("#trackMapStyleSelect").val();Qe(t.toString()),$("#launchDigiFlag").prop("disabled",!1)}),y}),$("#menuContent").append('<button type="button" id="launchDigiFlag" class="btn btn-success">Start DigiFlag</button>'),$("#launchDigiFlag").on("click",()=>{$(".menu-box").remove(),$("body").append(`<img src="${k("void")}" id="digiflag" class="center-screen">`),$("#digiflag").insertBefore(".bottom-screen"),$(".bottom-screen:not(:hover)").animate({opacity:0},2e3,"swing",function(){$(".bottom-screen").removeAttr("style")}),$("#zoomIn,#zoomOut,#zoomReset").show(),$("#zoomControl").css("z-index",1),_=!0})})}async function ne(e){o&&r("Link started...");try{if(await W.LiveTimingAPIGraphQL(f,"Heartbeat"))Y();else{if(e){Y();return}$("#tagLink").removeClass(),$("#tagSession").removeClass(),$("#raceName").removeClass(),$("#tagLink").addClass("badge text-bg-warning"),$("#raceName").addClass("text-bg-warning"),$("#tagSession").addClass("badge text-bg-warning"),$("#networkSettings").hide(),$("#tagLink").text("You are Connected to F1MV, but the Live/Replay Timing Window is not open."),$("#checkNetworkSettings,#infoTag").hide(),$("#raceName").text("Unable to Retrieve Current Session from F1MV"),setTimeout(()=>{x()},1e3)}}catch{if(e){Y();return}$("#tagLink").addClass("badge text-bg-danger"),$("#tagSession").addClass("badge text-bg-danger"),$("#raceName").addClass("text-bg-danger"),$("#tagLink").text("Failed to connect to F1MV"),$("#raceName").text("Failed to Retrieve Current Session"),$("#networkSettings").show(),$("#checkNetworkSettings,#infoTag").show(),$("#infoTag").text("Maybe you are trying to connect to another host? Maybe your port isn't the default one?"),$("#checkNetworkSettings").text("Move your Mouse to the Bottom Right Corner & Click on the Settings Gear to check your Network Settings."),setTimeout(()=>{x()},5e3)}}$(function(){_e(),E===!1&&x(),$("#version").text(`DigiFlag Version: ${Ae}`),$("#raceName").text(N),$(".bottom-screen:not(:hover)").css("opacity",1),$("#linkF1MV").remove(),$("#settingsButton").one("click",()=>{$("#networkSettings").append(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="globe" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10"/>
        <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
      </svg>`),$("#networkSettings").append('<h5 data-i18n="network">Network</h5>'),$("#networkSettings").append(`<label for="ip">Multiviewer API IP:</label>
            <input type="text" class="form-control-sm text-bg-dark" value="${f.host}" id="ip">`),$("#networkSettings").append(`<label for="port">Multiviewer API Port:</label>
            <input type="text" class="form-control-sm text-bg-dark" maxlength="5" value="${f.port}" id="port">`),$("#networkSettings").append($("<div/>",{class:"networkbuttons-container"}).append('<button type="button" id="updateSettings" class="btn-sm btn btn-primary" data-i18n="saveNetworkSettings">Save Network Settings</button>','<button type="button" id="restoreSettings" class="btn-sm btn btn-danger" data-i18n="restoreDefaultSettings">Restore Default Network Settings </button>')),$("#updateSettings").on("click",()=>{o&&r("Editing Settings...");const e=$("#ip").val().toString();f.host=e,o&&r($("#ip").text()),o&&r(`IP = ${$("#ip").val()} = ${f.host}`);const t=$("#port").val().toString();f.port=parseInt(t),o&&r($("#port").text()),o&&r(`PORT = ${$("#port").val()} = ${f.port}`),Ge(f.host,f.port)}),$("#restoreSettings").on("click",()=>{$("#ip").val("localhost"),$("#port").val(10101),Be()})}),$("#newInstance").on("click",()=>{ae()}),$("#openGithub").on("click",()=>{ae("https://github.com/LapsTimeOFF/DigiFlag_F1MV")}),$("#zoomIn").on("click",()=>{const e=A=A+.25;e>=1.75&&(A=.75),$("main,.center-screen").css({transform:"scale("+e+")"})}),$("#zoomOut").on("click",()=>{const e=A=A-.25;e<=.25&&(A=1.25),$("main,.center-screen").css({transform:"scale("+e+")"})}),$("#zoomReset").on("click",()=>{$("main,.center-screen").removeAttr("style"),A=1})});const We=async()=>{if(_===!1)return;const e=V.RaceControlMessages;if(e.Messages.length===te.Messages.length)o&&r("No new messages.");else{o&&r("New message"),te=e;const a=e.Messages.filter(n=>n.Category==="Flag"||n.Category==="Other"||n.Category==="SafetyCar"||n.Category==="Drs"||n.Message.match(/ROLLING START/i)||n.Message.match(/STANDING START/i)).slice(-1)[0];if(o&&console.log("Most Recent Filtered Message: "),o&&console.table(a),o&&console.log("Most Recent RCM Message: "),o&&console.table(e.Messages.slice(-1)[0]),a.Message.match(/BLACK AND ORANGE/i)&&(a.Category="Flag",a.Flag="BLACK AND ORANGE"),a.Message.match(/BLACK AND WHITE/i)){l("blackandwhite",s),await u(3500);const n=a.RacingNumber;n in M[C].gifs?(l(n,s),await u(3500),p(n)):o&&console.log(`No racing number GIF found for ${n}`),p("blackandwhite");return}if(a.SubCategory==="TimePenalty"){const n=a.Message.match(/CAR (\d+)/i);if(n){const i=n[1];o&&console.log(`Car Number: ${i}`),a.Message.match(/5 SECOND TIME PENALTY/i)&&(l("timepenalty5sec",s),await u(3500),p("timepenalty5sec"),l(i,s),await u(3500),p(i)),a.Message.match(/10 SECOND TIME PENALTY/i)&&(l("timepenalty10sec",s),await u(3500),p("timepenalty10sec"),l(i,s),await u(3500),p(i))}o&&(console.log("Most Recent RCM Message: "),console.table(e.Messages.slice(-1)[0])),o&&(console.log("Most Recent RCM Message: "),console.table(e.Messages.slice(-1)[0]))}if(a.Message.match(/BLACK AND ORANGE/i)&&(a.Category="Flag",a.Flag="BLACK AND ORANGE"),a.Message.match(/BLACK AND ORANGE/i)&&(a.Category="Flag",a.Flag="BLACK AND ORANGE"),a.Message.match(/ROLLING START/i)&&a.SubCategory!=="IncidentInvestigationAfterSession"){l("rs",s),await u(2e4),p("rs");return}if(a.Message.match(/STANDING START/i)){l("ss",s),await u(2e4),p("ss");return}if(a.Message.match(/DRS ENABLED/i)){l("DRSenabled",s),await u(3500),p("DRSenabled");return}if(a.Message.match(/DRS DISABLED/i)){l("DRSdisabled",s),await u(3500),p("DRSdisabled");return}if(a.SubCategory==="TrackSurfaceSlippery"){l("slippery",s),await u(5e3),p("slippery");return}if(a.Category==="SafetyCar"&&a.Mode!=="VIRTUAL SAFETY CAR"&&(b=!0,l("sc",s)),a.Mode==="VIRTUAL SAFETY CAR"&&(v=!0,l("vsc",s)),a.Flag==="CHEQUERED"){l("chequered",s),await u(9e4),p("chequered");return}if(a.Scope==="Track"){if(a.Flag==="RED"){l("red",s);return}b=!1,v=!1,w=!1,l("green",s),await u(2500),p("green");return}if(a.Category==="Flag")switch(a.Flag){case"YELLOW":l("yellow",s);break;case"DOUBLE YELLOW":l("dyellow",s);break;case"CLEAR":l("green",s),await u(2500),p("green");break;case"RED":w=!0,l("red",s),await u(9e4),p("red");break;case"BLUE":l("blue",s),await u(1e3),p("blue");break}}};async function Ue(){if(!_)return;const e=V.TrackStatus.Status;e==="1"&&(b||v||w||O)&&(o&&r("New track status : Green"),b=!1,O=!1,v=!1,w=!1,l("green",s),await u(2500),p("green")),e==="2"&&(o&&r("New track status : Yellow"),b=!1,O=!0,v=!1,w=!1),e==="4"&&(o&&r("New track status : SC"),b=!0,O=!1,v=!1,w=!1),e==="5"&&(o&&r("New track status : Red"),b=!1,O=!1,v=!1,w=!0),e==="6"&&(o&&r("New track status : VSC"),b=!1,O=!1,v=!0,w=!1)}async function He(){if(!_||j)return;const e=V.WeatherData.Rainfall;switch(o&&console.log(e),e){case"1":B=!0,o&&console.log(`Rain Status ${B}`),D||(l("rain",s),D=!0);break;case"0":B=!1,o&&console.log(`Rain Status ${B}`),D&&(D=!1,l("void",s));break}}async function ze(){try{return _&&(V=await W.LiveTimingAPIGraphQL(f,["RaceControlMessages","TrackStatus","WeatherData"])),V}catch(e){return console.error(e),console.log("Reloaded Window Due to Disconnect"),window.location.reload(),null}}setInterval(ze,100);setInterval(We,100);setInterval(He,100);setInterval(Ue,100);
